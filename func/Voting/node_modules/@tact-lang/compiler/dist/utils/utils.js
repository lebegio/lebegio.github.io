"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.topologicalSort = topologicalSort;
exports.getMethodId = getMethodId;
const crc16_1 = require("./crc16");
const errors_1 = require("../errors");
function topologicalSort(src, references) {
    const result = [];
    const visited = new Set();
    const visiting = new Set();
    const visit = (src) => {
        if (visiting.has(src)) {
            (0, errors_1.throwInternalCompilerError)("Cycle detected");
        }
        if (!visited.has(src)) {
            visiting.add(src);
            for (const r of references(src)) {
                visit(r);
            }
            visiting.delete(src);
            visited.add(src);
            result.push(src);
        }
    };
    for (const s of src) {
        visit(s);
    }
    return result;
}
function getMethodId(name) {
    return ((0, crc16_1.crc16)(name) & 0xffff) | 0x10000;
}
